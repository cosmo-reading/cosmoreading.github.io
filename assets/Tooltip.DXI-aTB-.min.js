import {
    r as i,
    cY as W,
    j as s,
    g as A,
    f as d,
    bW as q,
    Q as G,
    R as U,
    t as m,
    b$ as Y,
    P as Z,
    x as y,
    V as $,
    af as C,
    bu as B,
    bv as K,
    X as J,
    y as L,
    Y as Q,
    cn as P,
    as as h,
    cZ as k,
    cH as X,
    cy as b,
    k as z,
    a5 as ee,
    a8 as S,
    c_ as te,
    o as ne,
    c$ as ae,
    d0 as re,
    a6 as se,
    ac as oe,
    bA as ie,
    bF as ce,
    cI as le
} from "./app.BSN4W8HM.min.js";
import {
    h as p,
    q as ue,
    i as me,
    s as pe,
    m as de,
    l as R,
    k as fe
} from "./RelatedRecommends.Su3EijRB.min.js";
import {
    c as ge
} from "./path.CF9Kc7wv.min.js";
import {
    S as he
} from "./TruncateShowOrHide.es3nm7ZL.min.js";
import {
    a as ve,
    N as Ne
} from "./novel_announcements.client.nMeqcv8h.min.js";
import {
    H as xe
} from "./NovelReviewScore.BA_adrvz.min.js";
import {
    T as Se
} from "./Tooltip.-lmH7J9G.min.js";
var Fe = function(e, t) {
    var n = i.useRef(function() {});
    i.useEffect(function() {
        n.current = e
    }), i.useEffect(function() {
        if (t !== null) {
            var a = setInterval(function() {
                return n.current()
            }, t || 0);
            return function() {
                return clearInterval(a)
            }
        }
    }, [t])
};

function Te({
    fallback: e,
    children: t
}) {
    const [n, a] = i.useState(!1);
    return W(() => {
        a(!0)
    }, []), n ? s(A, {
        children: t
    }) : s(A, {
        children: e
    })
}

function we({
    novel: e,
    isLoading: t
}) {
    return d(p, {
        content: e,
        isLoading: t,
        viewLogDisabled: !0,
        clickEvent: q.ClickRelatedSeries,
        children: [s(p.Image, {}), d(p.TextWrapper, {
            children: [s(p.ReviewScore, {
                className: ue
            }), s(p.Title, {
                className: me
            })]
        })]
    })
}

function I({
    novels: e,
    isLoading: t
}) {
    const n = G(U.downLg),
        a = pe();
    return s(R, {
        slidesPerView: a,
        slidesPerGroup: n ? 1 : 6,
        className: m(de, "!py-0"),
        isLoading: t,
        children: e == null ? void 0 : e.map((o, r) => s(R.Slide, {
            className: "!w-[calc((100%+12px)/2.33-12px)] xs2:!w-180 sm2:!w-[calc((100%+12px)/4-12px)] md:!w-[calc((100%+16px)/4-16px)] lg:!w-[calc((100%+16px)/6-16px)]",
            "data-amplitude-params": JSON.stringify({
                itemSlot: r,
                ...Y(o)
            }),
            children: s(we, {
                novel: o,
                isLoading: t
            })
        }, r))
    })
}
const v = s(I, {
    novels: Array(10).fill(void 0),
    isLoading: !0
});

function Ae({
    novel: e
}) {
    const t = y(J, {
            genresFilter: {
                genres: e == null ? void 0 : e.genres,
                operator: $.Or
            },
            status: C.All,
            sortType: B.Random,
            sortDirection: K.ASC,
            count: E + 1
        }),
        {
            data: n
        } = L(Q, o => o.searchNovels, t, ["related-novels", e == null ? void 0 : e.id], {
            suspense: !0,
            staleTime: 1e3 * 60 * 60 * 24
        }),
        a = i.useMemo(() => (n == null ? void 0 : n.items.filter(o => o.id != (e == null ? void 0 : e.id)).slice(0, E)) ? ? null, [n, e == null ? void 0 : e.id]);
    return a ? s(I, {
        novels: a
    }) : v
}

function We(e) {
    const {
        ref: t,
        inView: n
    } = Z({
        triggerOnce: !0
    });
    return s(Te, {
        fallback: v,
        children: s("div", {
            ref: t,
            children: n ? s(i.Suspense, {
                fallback: v,
                children: s(Ae, { ...e
                })
            }) : v
        })
    })
}
const E = 5,
    be = 10,
    M = "anon-chapters-read";

function Re() {
    if (!k()) return {
        count: 0,
        urlsAllowed: []
    };
    const e = localStorage.getItem(M);
    return e ? JSON.parse(e) : {
        count: 0,
        urlsAllowed: []
    }
}

function qe(e, t) {
    if (!k()) return;
    const n = `${e}/${t}`,
        a = Re();
    a.urlsAllowed.some(o => o === n) || a.count >= be || (a.urlsAllowed.push(n), a.count += 1, localStorage.setItem(M, JSON.stringify(a)))
}
const Ge = ({
        user: e,
        novelId: t
    }) => {
        var n, a, o;
        return !!((n = e == null ? void 0 : e.permissions) != null && n.roles.some(r => ["Admin", "Translator"].includes(r == null ? void 0 : r.name)) || (a = e == null ? void 0 : e.permissions) != null && a.roles.some(r => ["Analyst", "Translator_B", "Editor"].includes(r == null ? void 0 : r.name)) && (o = e.permissions) != null && o.objects.some(r => r.type === P.NovelObject && r.id === t))
    },
    Ue = ({
        user: e,
        novelId: t
    }) => {
        var o, r;
        const n = (o = e == null ? void 0 : e.permissions) == null ? void 0 : o.roles.some(c => ["Admin", "Translator"].includes(c.name)),
            a = (r = e == null ? void 0 : e.permissions) == null ? void 0 : r.objects.some(c => c.type === P.NovelObject && c.id === t);
        return n || a
    },
    Ye = ({
        user: e,
        novel: t,
        vipFreeNovels: n,
        unlockedNovels: a
    }) => {
        var u;
        if (!e || !n || !a) return !1;
        const {
            isVipActive: o,
            vipFreeNovelsLimit: r
        } = X(e), c = a.length < (r ? ? 0);
        return !(!o || ![b.Silver, b.Gold].includes(((u = e.vip) == null ? void 0 : u.type) ? ? -1) || !c || a.some(l => z(l.id, "novelId") === t.id) || !n.map(l => l.id).includes(t.id))
    },
    Ze = ({
        chapter: e,
        chapterGroup: t
    }) => !!e && h(t.fromChapterNumber) <= h(e.number) && h(t.toChapterNumber) >= h(e.number);
var _;

function T() {
    return T = Object.assign ? Object.assign.bind() : function(e) {
        for (var t = 1; t < arguments.length; t++) {
            var n = arguments[t];
            for (var a in n) Object.prototype.hasOwnProperty.call(n, a) && (e[a] = n[a])
        }
        return e
    }, T.apply(this, arguments)
}
var $e = function(t) {
        return i.createElement("svg", T({
            width: 20,
            height: 20,
            viewBox: "0 0 20 20",
            fill: "none",
            xmlns: "http://www.w3.org/2000/svg"
        }, t), _ || (_ = i.createElement("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M14.583 5.417V7.25a2.75 2.75 0 0 1 2.75 2.75v6.417a2.75 2.75 0 0 1-2.75 2.75H5.417a2.75 2.75 0 0 1-2.75-2.75V10a2.75 2.75 0 0 1 2.75-2.75V5.417a4.583 4.583 0 1 1 9.166 0ZM8.055 3.472a2.75 2.75 0 0 0-.805 1.945V7.25h5.5V5.417a2.75 2.75 0 0 0-4.695-1.945ZM10 10.917a1.366 1.366 0 0 0-.917 2.392v1.274a.916.916 0 1 0 1.834 0V13.31A1.366 1.366 0 0 0 10 10.917Z",
            fill: "currentColor"
        })))
    },
    O;

function w() {
    return w = Object.assign ? Object.assign.bind() : function(e) {
        for (var t = 1; t < arguments.length; t++) {
            var n = arguments[t];
            for (var a in n) Object.prototype.hasOwnProperty.call(n, a) && (e[a] = n[a])
        }
        return e
    }, w.apply(this, arguments)
}
var Be = function(t) {
    return i.createElement("svg", w({
        width: 12,
        height: 11,
        viewBox: "0 0 12 11",
        fill: "currentColor",
        xmlns: "http://www.w3.org/2000/svg"
    }, t), O || (O = i.createElement("path", {
        fillRule: "evenodd",
        clipRule: "evenodd",
        d: "M9.818 1.682a5.4 5.4 0 1 0-7.636 7.636 5.4 5.4 0 0 0 7.636-7.636ZM1.68 5.5A4.32 4.32 0 0 1 6 1.18 2.16 2.16 0 0 1 6 5.5a2.16 2.16 0 1 0 0 4.32A4.32 4.32 0 0 1 1.68 5.5ZM6 2.53a.81.81 0 1 1 0 1.62.81.81 0 0 1 0-1.62Zm-.81 5.13a.81.81 0 1 1 1.62 0 .81.81 0 0 1-1.62 0Z"
    })))
};

function Ee({
    className: e,
    publishedDate: t,
    title: n = "",
    link: a = "",
    onClose: o
}) {
    const r = ee(S(t).unix());
    return n ? d("article", {
        className: m("rounded-[12px] pl-[12px] pr-[8px] pb-[12px] shadow-ww-text-container dark:bg-gray-950", e),
        children: [d("div", {
            className: "flex",
            children: [d("div", {
                className: "flex flex-1 pt-[10px] pb-[6px]",
                children: [s(te, {
                    className: "h-[16px] w-[16px] text-blue-600"
                }), t && s("span", {
                    className: "font-set-r13 ml-[4px] text-gray-600 dark:text-gray-400",
                    children: r
                })]
            }), s("button", {
                className: "-mr-[8px] p-[8px]",
                onClick: o,
                children: s(he, {
                    className: "h-[16px] w-[16px] text-gray-500 dark:text-gray-700"
                })
            })]
        }), s(ne, {
            to: a,
            className: "font-set-sb14 text-gray-t1 line-clamp-2 md:font-set-sb16 md:line-clamp-1",
            children: n
        })]
    }) : null
}

function _e({
    novelId: e,
    novelStatus: t,
    isSponsorsOnly: n,
    suspense: a = !1,
    enabled: o = !0
}) {
    const r = y(ve, {
            novelSelector: {
                oneofKind: "novelId",
                novelId: e
            },
            pageInfo: {
                page: 1,
                count: 1
            },
            filter: {
                isSponsorsOnly: n !== void 0 ? {
                    value: n
                } : void 0
            }
        }),
        {
            data: c,
            isFetching: u
        } = L(Ne, l => l.getNovelAnnouncements, r, ["novel-news", e, {
            isSponsorsOnly: n
        }, 1, 1], {
            suspense: a,
            enabled: o && t === C.Active,
            cacheTime: 1e3 * 60 * 60,
            staleTime: 1e3 * 60 * 60,
            keepPreviousData: !0
        });
    return {
        data: c == null ? void 0 : c.items,
        isFetching: u
    }
}
const Oe = "read-announcements";

function ye({
    classes: e,
    novelId: t,
    novelStatus: n,
    novelSlug: a
}) {
    const [o, r, , c] = re(Oe, Array()), [u, l] = i.useState(!1), {
        data: V = []
    } = _e({
        novelId: t,
        novelStatus: n
    }), [f] = V, {
        title: H,
        entityId: N,
        whenToPublish: x,
        slug: j
    } = f ? ? {}, D = i.useMemo(() => {
        if (!f) return !1;
        const g = S();
        return !S.unix(se(x)).isBefore(g.subtract(7, "day"))
    }, [f, x]), F = i.useCallback(() => {
        const g = new Set(o);
        g.add(N), r(Array.from(g)), l(!0)
    }, [N, o, r]);
    return !f || !D || o.includes(N) || !c ? null : s(ie, { in: !u,
        appear: !1,
        className: m("px-0", e == null ? void 0 : e.collapse),
        children: s(Ee, {
            className: e == null ? void 0 : e.root,
            publishedDate: oe(x) ? ? void 0,
            title: H,
            link: ge({
                novelSlug: a,
                novelAnnouncementSlug: j
            }),
            onClose: F
        })
    })
}
const Ke = ae(ye);

function Ce({
    children: e,
    ...t
}) {
    return s("article", {
        className: "py-12 md:pb-0",
        ...t,
        children: e
    })
}
const Le = ({
    isLoading: e
}) => s(xe, {
    item: !e,
    skeletonProps: ce,
    children: s("h1", {
        className: m("text-gray-t1", fe),
        children: "Related Novels"
    })
});
Ce.Title = Le;

function Je({
    novel: e,
    chapter: t
}) {
    return i.useMemo(() => le({
        novel: e,
        chapter: t
    }), [e, t])
}

function Qe({
    classes: e,
    children: t,
    flipEnabled: n = !0,
    ...a
}) {
    return s(Se, {
        arrow: !0,
        enterTouchDelay: 0,
        classes: { ...e,
            arrow: m("text-black/[.85] text-[14px]", e == null ? void 0 : e.arrow),
            tooltip: m("font-set-m14 bg-black/[.85] rounded-[12px] py-[13px] px-[16px] text-white !mt-[8px] max-w-[300px]", e == null ? void 0 : e.tooltip),
            popper: "z-[2]"
        },
        leaveDelay: 0,
        PopperProps: {
            modifiers: [{
                name: "flip",
                enabled: n
            }]
        },
        ...a,
        children: t
    })
}
export {
    Ke as N, Ce as R, $e as S, Qe as T, We as a, Je as b, Ge as c, Ue as d, Be as e, Ye as f, Te as g, Ze as h, qe as s, Fe as u
};
//# sourceMappingURL=Tooltip.DXI-aTB-.min.js.map