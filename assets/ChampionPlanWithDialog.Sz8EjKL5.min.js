import {
    r as c,
    U as C,
    R as N,
    f as o,
    j as a,
    cE as D,
    cv as B,
    q as M,
    t as S,
    h as b,
    cp as A,
    g as P,
    ek as x,
    as as W,
    el as k,
    em as j,
    aq as $,
    d1 as q
} from "./app.BSN4W8HM.min.js";
import {
    T as y
} from "./TruncateDisclosure.EJsU_sLh.min.js";
import {
    A as z
} from "./ActivateButton.CUtwAnvT.min.js";
import {
    u as F
} from "./html.CLZ4OSMb.min.js";
import {
    i as T,
    n as J
} from "./util.CeAI_f06.min.js";
import {
    S as K
} from "./SubscribeDialog.DvhIwTo5.min.js";
var O = T ? c.useLayoutEffect : c.useEffect,
    L = {
        x: 0,
        y: 0,
        width: 0,
        height: 0,
        top: 0,
        left: 0,
        bottom: 0,
        right: 0
    };

function Q() {
    var e = c.useState(null),
        t = e[0],
        n = e[1],
        i = c.useState(L),
        f = i[0],
        d = i[1],
        r = c.useMemo(function() {
            return new window.ResizeObserver(function(m) {
                if (m[0]) {
                    var s = m[0].contentRect,
                        p = s.x,
                        h = s.y,
                        g = s.width,
                        u = s.height,
                        l = s.top,
                        w = s.left,
                        v = s.bottom,
                        R = s.right;
                    d({
                        x: p,
                        y: h,
                        width: g,
                        height: u,
                        top: l,
                        left: w,
                        bottom: v,
                        right: R
                    })
                }
            })
        }, []);
    return O(function() {
        if (t) return r.observe(t),
            function() {
                r.disconnect()
            }
    }, [t]), [n, f]
}
const U = T && typeof window.ResizeObserver < "u" ? Q : function() {
    return [J, L]
};
var Y = (e => (e.NovelCover = "Series Cover", e.Store = "Store", e.KarmaPaywallLayer = "Karma Paywall Layer", e.WtuPaywallLayer = "WTU Paywall Layer", e.AdvancePaywallLayer = "Advance Paywall Layer", e))(Y || {});

function G() {
    const e = C(N.downSm, {
            noSsr: !0
        }),
        t = C(N.downMd, {
            noSsr: !0
        });
    return {
        isDownSm: e,
        isDownMd: t
    }
}
const X = c.forwardRef(function({
        actionType: t,
        name: n,
        htmlDesc: i,
        advChapterCount: f,
        price: d,
        onAction: r,
        onChangePaymentMethod: m,
        ...s
    }, p) {
        const h = F(i ? ? "", {
                removeTags: ["hr", "img"]
            }),
            u = !["unsubscribe", "reactivate"].includes(t),
            {
                isDownSm: l
            } = G();
        return o("div", {
            className: "flex h-full w-full max-w-[400px] flex-col overflow-hidden rounded-12 shadow-ww-text-container dark:bg-gray-900 dark:shadow-ww-text-container-dark",
            ...s,
            ref: p,
            children: [o(Z, {
                className: "flex items-center shadow-ww-underline",
                children: [o("div", {
                    className: "mr-4",
                    children: [!u && a("div", {
                        className: "font-set-sb12 text-blue-500",
                        children: "Subscribed"
                    }), o("div", {
                        className: "flex flex-col space-y-4",
                        children: [a(H, {
                            advChapterCount: f
                        }), a(I, {
                            price: d
                        })]
                    })]
                }), a("div", {
                    className: "ml-auto",
                    children: u ? a(z, {
                        className: "h-32 w-108",
                        onClick: () => {
                            r == null || r(t)
                        },
                        "data-amplitude-click-event": D.ClickChampionSubscribe,
                        children: t.toUpperCase()
                    }) : o("div", {
                        className: "flex w-110 flex-col items-end gap-y-4",
                        children: [a(B, {
                            className: "h-32 w-108",
                            onClick: () => {
                                r == null || r(t)
                            },
                            children: t.toUpperCase()
                        }), t === "unsubscribe" && o("div", {
                            className: "flex cursor-pointer items-center gap-x-2 text-gray-desc hover:text-blue-600 dark:hover:text-blue-500",
                            onClick: m,
                            children: [a("div", {
                                className: "font-set-m10 text-right sm:font-set-m12",
                                children: "Change payment method"
                            }), a(M, {
                                className: "h-10 w-10 rotate-90"
                            })]
                        })]
                    })
                })]
            }), a(E, {
                className: "flex-grow text-gray-desc",
                children: o(P, {
                    children: [a("div", {
                        className: "font-set-sb12 sm:font-set-sb13",
                        children: n
                    }), l ? o(y, {
                        children: [a(y.Content, {
                            className: "font-set-r12 scroll-ww-plan-card max-h-[102px] overflow-y-auto pt-2",
                            children: h
                        }), a(y.Toggle, {
                            className: "font-set-m12",
                            showingComponent: a("span", {
                                children: "Show more"
                            }),
                            hidingComponent: a("span", {
                                children: "Show less"
                            })
                        })]
                    }) : a("div", {
                        className: "font-set-r13 scroll-ww-plan-card max-h-[114px] overflow-y-auto pt-2",
                        children: h
                    })]
                })
            })]
        })
    }),
    Z = ({
        children: e,
        className: t
    }) => a("div", {
        className: S("bg-white py-10 px-12 dark:bg-black/20", t),
        children: e
    }),
    E = ({
        children: e,
        className: t
    }) => a("div", {
        className: S("bg-gray-50 px-12 pt-8 pb-12 dark:bg-transparent", t),
        children: e
    }),
    H = ({
        advChapterCount: e
    }) => {
        let t = "";
        if (e) {
            const n = e === -1 ? "All" : `${e}`;
            t += ` + ${n} Advance`
        }
        return o("div", {
            className: "font-set-sb14 flex flex-wrap text-gray-t2",
            children: [a("div", {
                children: "All Chapters"
            }), t && a("div", {
                className: "w-100 whitespace-pre",
                children: t
            })]
        })
    },
    I = ({
        price: e
    }) => {
        const [t, {
            width: n
        }] = U(), i = n < 124;
        return o("div", {
            ref: t,
            className: b(i ? "gap-x-2" : "gap-x-4", "flex items-center"),
            children: [a("div", {
                className: b(i ? "font-set-sb15" : "font-set-sb16 sm:font-set-sb18", "text-blue-600"),
                children: A(e)
            }), a("div", {
                className: b(i ? "font-set-r10" : "font-set-r13 sm:font-set-r14", "text-gray-desc"),
                children: "/ month"
            })]
        })
    };

function re({
    plan: e,
    currentSubscription: t,
    onSelectPlan: n,
    handleProcessingStateChange: i
}) {
    var u;
    const [f, d] = c.useState(!1), [r, m] = c.useState(!1), s = c.useRef(null), p = l => {
        l === "unsubscribe" ? m(!0) : d(!0)
    }, h = l => {
        l.preventDefault(), d(!0)
    }, g = f || r;
    return o(P, {
        children: [a(X, {
            actionType: x(t, e),
            name: e.name,
            htmlDesc: (u = e == null ? void 0 : e.description) == null ? void 0 : u.value,
            advChapterCount: e.advanceChapterCount,
            price: W(e.price),
            onAction: p,
            onChangePaymentMethod: h,
            "data-amplitude-params": JSON.stringify({ ...k(e),
                actionType: x(t, e)
            }),
            ref: s
        }), g && a(K, {
            opened: f,
            onClose: () => d(!1),
            cancelOpened: r,
            onCancelClose: () => m(!1),
            mode: "confirm",
            plan: e,
            subscription: t,
            onSubscribe: (l, w) => {
                var v;
                (v = s.current) == null || v.setAttribute("data-amplitude-params", JSON.stringify({ ...k(e),
                    actionType: x(t, e),
                    paymentMethod: j[(w == null ? void 0 : w.type) || $.UnknownType]
                })), q(D.BuyChampionSubscribe, s.current), n == null || n(e)
            },
            onProcessingStateChange: i
        })]
    })
}
export {
    Y as C, re as a, G as b, U as u
};
//# sourceMappingURL=ChampionPlanWithDialog.Sz8EjKL5.min.js.map